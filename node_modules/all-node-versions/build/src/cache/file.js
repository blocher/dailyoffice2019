"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setCacheFileContent=exports.getCacheFileContent=exports.getCacheFile=void 0;var _fs=require("fs");
var _process=require("process");

var _globalCacheDir=_interopRequireDefault(require("global-cache-dir"));
var _writeFileAtomic=_interopRequireDefault(require("write-file-atomic"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}


const getCacheFile=async function(){
const cacheDir=await(0,_globalCacheDir.default)(CACHE_DIR);
const cacheFilename=_process.env.TEST_CACHE_FILENAME||CACHE_FILENAME;
return`${cacheDir}/${cacheFilename}`;
};exports.getCacheFile=getCacheFile;

const CACHE_DIR="nve";
const CACHE_FILENAME="versions.json";


const getCacheFileContent=async function(cacheFile){
const cacheFileContent=await _fs.promises.readFile(cacheFile,"utf8");
const{lastUpdate,...versionsInfo}=JSON.parse(cacheFileContent);
const age=Date.now()-lastUpdate;
return{versionsInfo,age};
};exports.getCacheFileContent=getCacheFileContent;


const setCacheFileContent=async function(cacheFile,versionsInfo){
const lastUpdate=Date.now();
const cacheContent={lastUpdate,...versionsInfo};
const cacheFileContent=`${JSON.stringify(cacheContent,null,2)}\n`;

try{
await(0,_writeFileAtomic.default)(cacheFile,cacheFileContent);




}catch{}
};exports.setCacheFileContent=setCacheFileContent;
//# sourceMappingURL=file.js.map