{"version":3,"file":"moize.js","sources":["../src/constants.ts","../src/utils.ts","../src/maxAge.ts","../src/stats.ts","../src/instance.ts","../src/component.ts","../src/maxArgs.ts","../src/serialize.ts","../src/options.ts","../src/updateCacheForKey.ts","../src/index.ts"],"sourcesContent":["import { Options } from './types';\n\n/**\n * @private\n *\n * @constant DEFAULT_OPTIONS\n */\nexport const DEFAULT_OPTIONS: Options = {\n    isDeepEqual: false,\n    isPromise: false,\n    isReact: false,\n    isSerialized: false,\n    isShallowEqual: false,\n    matchesArg: undefined,\n    matchesKey: undefined,\n    maxAge: undefined,\n    maxArgs: undefined,\n    maxSize: 1,\n    onExpire: undefined,\n    profileName: undefined,\n    serializer: undefined,\n    updateCacheForKey: undefined,\n    transformArgs: undefined,\n    updateExpire: false,\n};\n","import { DEFAULT_OPTIONS } from './constants';\nimport {\n    Expiration,\n    Fn,\n    IsEqual,\n    IsMatchingKey,\n    Key,\n    Moizeable,\n    Moized,\n    Options,\n} from './types';\n\n/**\n * @private\n *\n * @description\n * method to combine functions and return a single function that fires them all\n *\n * @param functions the functions to compose\n * @returns the composed function\n */\nexport function combine<Arg, Result>(\n    ...functions: Fn<Arg>[]\n): Fn<Arg, Result> | undefined {\n    return functions.reduce(function (f: any, g: any) {\n        if (typeof f === 'function') {\n            return typeof g === 'function'\n                ? function (this: any) {\n                      f.apply(this, arguments);\n                      g.apply(this, arguments);\n                  }\n                : f;\n        }\n\n        if (typeof g === 'function') {\n            return g;\n        }\n    });\n}\n\n/**\n * @private\n *\n * @description\n * method to compose functions and return a single function\n *\n * @param functions the functions to compose\n * @returns the composed function\n */\nexport function compose<Method>(...functions: Method[]): Method {\n    return functions.reduce(function (f: any, g: any) {\n        if (typeof f === 'function') {\n            return typeof g === 'function'\n                ? function (this: any) {\n                      return f(g.apply(this, arguments));\n                  }\n                : f;\n        }\n\n        if (typeof g === 'function') {\n            return g;\n        }\n    });\n}\n\n/**\n * @private\n *\n * @description\n * find the index of the expiration based on the key\n *\n * @param expirations the list of expirations\n * @param key the key to match\n * @returns the index of the expiration\n */\nexport function findExpirationIndex(expirations: Expiration[], key: Key) {\n    for (let index = 0; index < expirations.length; index++) {\n        if (expirations[index].key === key) {\n            return index;\n        }\n    }\n\n    return -1;\n}\n\n/**\n * @private\n *\n * @description\n * create function that finds the index of the key in the list of cache keys\n *\n * @param isEqual the function to test individual argument equality\n * @param isMatchingKey the function to test full key equality\n * @returns the function that finds the index of the key\n */\nexport function createFindKeyIndex(\n    isEqual: IsEqual,\n    isMatchingKey: IsMatchingKey | undefined\n) {\n    const areKeysEqual: IsMatchingKey =\n        typeof isMatchingKey === 'function'\n            ? isMatchingKey\n            : function (cacheKey: Key, key: Key) {\n                  for (let index = 0; index < key.length; index++) {\n                      if (!isEqual(cacheKey[index], key[index])) {\n                          return false;\n                      }\n                  }\n\n                  return true;\n              };\n\n    return function (keys: Key[], key: Key) {\n        for (let keysIndex = 0; keysIndex < keys.length; keysIndex++) {\n            if (\n                keys[keysIndex].length === key.length &&\n                areKeysEqual(keys[keysIndex], key)\n            ) {\n                return keysIndex;\n            }\n        }\n\n        return -1;\n    };\n}\n\n/**\n * @private\n *\n * @description\n * merge two options objects, combining or composing functions as necessary\n *\n * @param originalOptions the options that already exist on the method\n * @param newOptions the new options to merge\n * @returns the merged options\n */\nexport function mergeOptions(\n    originalOptions: Options,\n    newOptions: Options\n): Options {\n    return !newOptions || newOptions === DEFAULT_OPTIONS\n        ? originalOptions\n        : {\n              ...originalOptions,\n              ...newOptions,\n              onCacheAdd: combine(\n                  originalOptions.onCacheAdd,\n                  newOptions.onCacheAdd\n              ),\n              onCacheChange: combine(\n                  originalOptions.onCacheChange,\n                  newOptions.onCacheChange\n              ),\n              onCacheHit: combine(\n                  originalOptions.onCacheHit,\n                  newOptions.onCacheHit\n              ),\n              transformArgs: compose(\n                  originalOptions.transformArgs,\n                  newOptions.transformArgs\n              ),\n          };\n}\n\nexport function isMoized(fn: Moizeable | Moized | Options): fn is Moized {\n    return typeof fn === 'function' && (fn as Moizeable).isMoized;\n}\n\nexport function setName(\n    fn: Moized,\n    originalFunctionName: string,\n    profileName: string\n) {\n    try {\n        const name = profileName || originalFunctionName || 'anonymous';\n\n        Object.defineProperty(fn, 'name', {\n            configurable: true,\n            enumerable: false,\n            value: `moized(${name})`,\n            writable: true,\n        });\n    } catch {\n        // For engines where `function.name` is not configurable, do nothing.\n    }\n}\n","import {\n    Cache,\n    Expiration,\n    Fn,\n    IsEqual,\n    IsMatchingKey,\n    Key,\n    OnCacheOperation,\n    Options,\n} from './types';\nimport { createFindKeyIndex, findExpirationIndex } from './utils';\n\n/**\n * @private\n *\n * @description\n * clear an active expiration and remove it from the list if applicable\n *\n * @param expirations the list of expirations\n * @param key the key to clear\n * @param shouldRemove should the expiration be removed from the list\n */\nexport function clearExpiration(\n    expirations: Expiration[],\n    key: Key,\n    shouldRemove?: boolean\n) {\n    const expirationIndex = findExpirationIndex(expirations, key);\n\n    if (expirationIndex !== -1) {\n        clearTimeout(expirations[expirationIndex].timeoutId);\n\n        if (shouldRemove) {\n            expirations.splice(expirationIndex, 1);\n        }\n    }\n}\n\n/**\n * @private\n *\n * @description\n * Create the timeout for the given expiration method. If the ability to `unref`\n * exists, then apply it to avoid process locks in NodeJS.\n *\n * @param expirationMethod the method to fire upon expiration\n * @param maxAge the time to expire after\n * @returns the timeout ID\n */\nexport function createTimeout(expirationMethod: () => void, maxAge: number) {\n    const timeoutId = setTimeout(expirationMethod, maxAge);\n\n    if (typeof timeoutId.unref === 'function') {\n        timeoutId.unref();\n    }\n\n    return timeoutId;\n}\n\n/**\n * @private\n *\n * @description\n * create a function that, when an item is added to the cache, adds an expiration for it\n *\n * @param expirations the mutable expirations array\n * @param options the options passed on initialization\n * @param isEqual the function to check argument equality\n * @param isMatchingKey the function to check complete key equality\n * @returns the onCacheAdd function to handle expirations\n */\nexport function createOnCacheAddSetExpiration(\n    expirations: Expiration[],\n    options: Options,\n    isEqual: IsEqual,\n    isMatchingKey: IsMatchingKey\n): OnCacheOperation {\n    const { maxAge } = options;\n\n    return function onCacheAdd(\n        cache: Cache,\n        moizedOptions: Options,\n        moized: Fn\n    ) {\n        const key: any = cache.keys[0];\n\n        if (findExpirationIndex(expirations, key) === -1) {\n            const expirationMethod = function () {\n                const findKeyIndex = createFindKeyIndex(isEqual, isMatchingKey);\n\n                const keyIndex: number = findKeyIndex(cache.keys, key);\n                const value: any = cache.values[keyIndex];\n\n                if (~keyIndex) {\n                    cache.keys.splice(keyIndex, 1);\n                    cache.values.splice(keyIndex, 1);\n\n                    if (typeof options.onCacheChange === 'function') {\n                        options.onCacheChange(cache, moizedOptions, moized);\n                    }\n                }\n\n                clearExpiration(expirations, key, true);\n\n                if (\n                    typeof options.onExpire === 'function' &&\n                    options.onExpire(key) === false\n                ) {\n                    cache.keys.unshift(key);\n                    cache.values.unshift(value);\n\n                    onCacheAdd(cache, moizedOptions, moized);\n\n                    if (typeof options.onCacheChange === 'function') {\n                        options.onCacheChange(cache, moizedOptions, moized);\n                    }\n                }\n            };\n\n            expirations.push({\n                expirationMethod,\n                key,\n                timeoutId: createTimeout(expirationMethod, maxAge),\n            });\n        }\n    };\n}\n\n/**\n * @private\n *\n * @description\n * creates a function that, when a cache item is hit, reset the expiration\n *\n * @param expirations the mutable expirations array\n * @param options the options passed on initialization\n * @returns the onCacheAdd function to handle expirations\n */\nexport function createOnCacheHitResetExpiration(\n    expirations: Expiration[],\n    options: Options\n): OnCacheOperation {\n    return function onCacheHit(cache: Cache) {\n        const key = cache.keys[0];\n        const expirationIndex = findExpirationIndex(expirations, key);\n\n        if (~expirationIndex) {\n            clearExpiration(expirations, key, false);\n\n            expirations[expirationIndex].timeoutId = createTimeout(\n                expirations[expirationIndex].expirationMethod,\n                options.maxAge\n            );\n        }\n    };\n}\n\n/**\n * @private\n *\n * @description\n * get the micro-memoize options specific to the maxAge option\n *\n * @param expirations the expirations for the memoized function\n * @param options the options passed to the moizer\n * @param isEqual the function to test equality of the key on a per-argument basis\n * @param isMatchingKey the function to test equality of the whole key\n * @returns the object of options based on the entries passed\n */\nexport function getMaxAgeOptions(\n    expirations: Expiration[],\n    options: Options,\n    isEqual: IsEqual,\n    isMatchingKey: IsMatchingKey\n): {\n    onCacheAdd: OnCacheOperation | undefined;\n    onCacheHit: OnCacheOperation | undefined;\n} {\n    const onCacheAdd =\n        typeof options.maxAge === 'number' && isFinite(options.maxAge)\n            ? createOnCacheAddSetExpiration(\n                  expirations,\n                  options,\n                  isEqual,\n                  isMatchingKey\n              )\n            : undefined;\n\n    return {\n        onCacheAdd,\n        onCacheHit:\n            onCacheAdd && options.updateExpire\n                ? createOnCacheHitResetExpiration(expirations, options)\n                : undefined,\n    };\n}\n","import {\n    Fn,\n    FunctionalComponent,\n    GlobalStatsObject,\n    OnCacheOperation,\n    Options,\n    StatsCache,\n    StatsProfile,\n} from './types';\n\nexport const statsCache: StatsCache = {\n    anonymousProfileNameCounter: 1,\n    isCollectingStats: false,\n    profiles: {},\n};\n\nlet hasWarningDisplayed = false;\n\nexport function clearStats(profileName?: string) {\n    if (profileName) {\n        delete statsCache.profiles[profileName];\n    } else {\n        statsCache.profiles = {};\n    }\n}\n\n/**\n * @private\n *\n * @description\n * activate stats collection\n *\n * @param isCollectingStats should stats be collected\n */\nexport function collectStats(isCollectingStats = true) {\n    statsCache.isCollectingStats = isCollectingStats;\n}\n\n/**\n * @private\n *\n * @description\n * create a function that increments the number of calls for the specific profile\n */\nexport function createOnCacheAddIncrementCalls(options: Options) {\n    const { profileName } = options;\n\n    return function () {\n        if (profileName && !statsCache.profiles[profileName]) {\n            statsCache.profiles[profileName] = {\n                calls: 0,\n                hits: 0,\n            };\n        }\n\n        statsCache.profiles[profileName].calls++;\n    };\n}\n\n/**\n * @private\n *\n * @description\n * create a function that increments the number of calls and cache hits for the specific profile\n */\nexport function createOnCacheHitIncrementCallsAndHits(options: Options) {\n    return function () {\n        const { profiles } = statsCache;\n        const { profileName } = options;\n\n        if (!profiles[profileName]) {\n            profiles[profileName] = {\n                calls: 0,\n                hits: 0,\n            };\n        }\n\n        profiles[profileName].calls++;\n        profiles[profileName].hits++;\n    };\n}\n\n/**\n * @private\n *\n * @description\n * get the profileName for the function when one is not provided\n *\n * @param fn the function to be memoized\n * @returns the derived profileName for the function\n */\nexport function getDefaultProfileName(\n    fn: Fn | FunctionalComponent<Record<string, unknown>>\n) {\n    const stack = new Error().stack;\n    const fnName =\n        (fn as FunctionalComponent<Record<string, unknown>>).displayName ||\n        fn.name ||\n        `Anonymous ${statsCache.anonymousProfileNameCounter++}`;\n\n    if (!stack) {\n        return fnName;\n    }\n\n    const lines = stack.split('\\n').slice(3);\n\n    let line: string;\n    let profileNameLocation: string;\n\n    for (let index = 0; index < lines.length; index++) {\n        line = lines[index];\n\n        if (\n            line.indexOf('/moize/') === -1 &&\n            line.indexOf(' (native)') === -1 &&\n            line.indexOf(' Function.') === -1\n        ) {\n            profileNameLocation = line.replace(/\\n/g, '\\\\n').trim();\n            break;\n        }\n    }\n\n    return profileNameLocation ? `${fnName} ${profileNameLocation}` : fnName;\n}\n\n/**\n * @private\n *\n * @description\n * get the usage percentage based on the number of hits and total calls\n *\n * @param calls the number of calls made\n * @param hits the number of cache hits when called\n * @returns the usage as a percentage string\n */\nexport function getUsagePercentage(calls: number, hits: number) {\n    return calls ? `${((hits / calls) * 100).toFixed(4)}%` : '0.0000%';\n}\n\n/**\n * @private\n *\n * @description\n * get the statistics for a given method or all methods\n *\n * @param [profileName] the profileName to get the statistics for (get all when not provided)\n * @returns the object with stats information\n */\nexport function getStats(profileName?: string): GlobalStatsObject {\n    if (!statsCache.isCollectingStats && !hasWarningDisplayed) {\n        console.warn(\n            'Stats are not currently being collected, please run \"collectStats\" to enable them.'\n        ); // eslint-disable-line no-console\n\n        hasWarningDisplayed = true;\n    }\n\n    const { profiles } = statsCache;\n\n    if (profileName) {\n        if (!profiles[profileName]) {\n            return {\n                calls: 0,\n                hits: 0,\n                usage: '0.0000%',\n            };\n        }\n\n        const { [profileName]: profile } = profiles;\n\n        return {\n            ...profile,\n            usage: getUsagePercentage(profile.calls, profile.hits),\n        };\n    }\n\n    const completeStats: StatsProfile = Object.keys(statsCache.profiles).reduce(\n        (completeProfiles, profileName) => {\n            completeProfiles.calls += profiles[profileName].calls;\n            completeProfiles.hits += profiles[profileName].hits;\n\n            return completeProfiles;\n        },\n        {\n            calls: 0,\n            hits: 0,\n        }\n    );\n\n    return {\n        ...completeStats,\n        profiles: Object.keys(profiles).reduce(\n            (computedProfiles, profileName) => {\n                computedProfiles[profileName] = getStats(profileName);\n\n                return computedProfiles;\n            },\n            {} as Record<string, StatsProfile>\n        ),\n        usage: getUsagePercentage(completeStats.calls, completeStats.hits),\n    };\n}\n\n/**\n * @private\n *\n * @function getStatsOptions\n *\n * @description\n * get the options specific to storing statistics\n *\n * @param {Options} options the options passed to the moizer\n * @returns {Object} the options specific to keeping stats\n */\nexport function getStatsOptions(\n    options: Options\n): {\n    onCacheAdd?: OnCacheOperation;\n    onCacheHit?: OnCacheOperation;\n} {\n    return statsCache.isCollectingStats\n        ? {\n              onCacheAdd: createOnCacheAddIncrementCalls(options),\n              onCacheHit: createOnCacheHitIncrementCallsAndHits(options),\n          }\n        : {};\n}\n","import { clearExpiration } from './maxAge';\nimport { clearStats, getStats } from './stats';\nimport {\n    Fn,\n    Key,\n    Memoized,\n    Moizeable,\n    MoizeConfiguration,\n    Moized,\n    Options,\n    StatsProfile,\n} from './types';\nimport { createFindKeyIndex } from './utils';\n\nconst ALWAYS_SKIPPED_PROPERTIES: Record<string, boolean> = {\n    arguments: true,\n    callee: true,\n    caller: true,\n    constructor: true,\n    length: true,\n    name: true,\n    prototype: true,\n};\n\n/**\n * @private\n *\n * @description\n * copy the static properties from the original function to the moized\n * function\n *\n * @param originalFn the function copying from\n * @param newFn the function copying to\n * @param skippedProperties the list of skipped properties, if any\n */\nexport function copyStaticProperties(\n    originalFn: Fn,\n    newFn: Fn,\n    skippedProperties: string[] = []\n) {\n    Object.getOwnPropertyNames(originalFn).forEach((property) => {\n        if (\n            !ALWAYS_SKIPPED_PROPERTIES[property] &&\n            skippedProperties.indexOf(property) === -1\n        ) {\n            const descriptor = Object.getOwnPropertyDescriptor(\n                originalFn,\n                property\n            );\n\n            if (descriptor.get || descriptor.set) {\n                Object.defineProperty(newFn, property, descriptor);\n            } else {\n                newFn[property as keyof typeof newFn] =\n                    originalFn[property as keyof typeof originalFn];\n            }\n        }\n    });\n}\n\n/**\n * @private\n *\n * @description\n * add methods to the moized fuction object that allow extra features\n *\n * @param memoized the memoized function from micro-memoize\n */\nexport function addInstanceMethods<OriginalFn extends Fn>(\n    memoized: Moizeable,\n    { expirations }: MoizeConfiguration<OriginalFn>\n) {\n    const { options } = memoized;\n\n    const findKeyIndex = createFindKeyIndex(\n        options.isEqual,\n        options.isMatchingKey\n    );\n\n    const moized = memoized as unknown as Moized<OriginalFn, Options>;\n\n    moized.clear = function () {\n        const {\n            _microMemoizeOptions: { onCacheChange },\n            cache,\n        } = moized;\n\n        cache.keys.length = 0;\n        cache.values.length = 0;\n\n        if (onCacheChange) {\n            onCacheChange(cache, moized.options, moized);\n        }\n\n        return true;\n    };\n\n    moized.clearStats = function () {\n        clearStats(moized.options.profileName);\n    };\n\n    moized.get = function (key: Key) {\n        const {\n            _microMemoizeOptions: { transformKey },\n            cache,\n        } = moized;\n\n        const cacheKey = transformKey ? transformKey(key) : key;\n        const keyIndex = findKeyIndex(cache.keys, cacheKey);\n\n        return keyIndex !== -1 ? moized.apply(this, key) : undefined;\n    };\n\n    moized.getStats = function (): StatsProfile {\n        return getStats(moized.options.profileName);\n    };\n\n    moized.has = function (key: Key) {\n        const { transformKey } = moized._microMemoizeOptions;\n\n        const cacheKey = transformKey ? transformKey(key) : key;\n\n        return findKeyIndex(moized.cache.keys, cacheKey) !== -1;\n    };\n\n    moized.keys = function () {\n        return moized.cacheSnapshot.keys;\n    };\n\n    moized.remove = function (key: Key) {\n        const {\n            _microMemoizeOptions: { onCacheChange, transformKey },\n            cache,\n        } = moized;\n\n        const keyIndex = findKeyIndex(\n            cache.keys,\n            transformKey ? transformKey(key) : key\n        );\n\n        if (keyIndex === -1) {\n            return false;\n        }\n\n        const existingKey = cache.keys[keyIndex];\n\n        cache.keys.splice(keyIndex, 1);\n        cache.values.splice(keyIndex, 1);\n\n        if (onCacheChange) {\n            onCacheChange(cache, moized.options, moized);\n        }\n\n        clearExpiration(expirations, existingKey, true);\n\n        return true;\n    };\n\n    moized.set = function (key: Key, value: any) {\n        const { _microMemoizeOptions, cache, options } = moized;\n        const { onCacheAdd, onCacheChange, transformKey } =\n            _microMemoizeOptions;\n\n        const cacheKey = transformKey ? transformKey(key) : key;\n        const keyIndex = findKeyIndex(cache.keys, cacheKey);\n\n        if (keyIndex === -1) {\n            const cutoff = options.maxSize - 1;\n\n            if (cache.size > cutoff) {\n                cache.keys.length = cutoff;\n                cache.values.length = cutoff;\n            }\n\n            cache.keys.unshift(cacheKey);\n            cache.values.unshift(value);\n\n            if (options.isPromise) {\n                cache.updateAsyncCache(moized);\n            }\n\n            if (onCacheAdd) {\n                onCacheAdd(cache, options, moized);\n            }\n\n            if (onCacheChange) {\n                onCacheChange(cache, options, moized);\n            }\n        } else {\n            const existingKey = cache.keys[keyIndex];\n\n            cache.values[keyIndex] = value;\n\n            if (keyIndex > 0) {\n                cache.orderByLru(existingKey, value, keyIndex);\n            }\n\n            if (options.isPromise) {\n                cache.updateAsyncCache(moized);\n            }\n\n            if (typeof onCacheChange === 'function') {\n                onCacheChange(cache, options, moized);\n            }\n        }\n    };\n\n    moized.values = function () {\n        return moized.cacheSnapshot.values;\n    };\n}\n\n/**\n * @private\n *\n * @description\n * add propeties to the moized fuction object that surfaces extra information\n *\n * @param memoized the memoized function\n * @param expirations the list of expirations for cache items\n * @param options the options passed to the moizer\n * @param originalFunction the function that is being memoized\n */\nexport function addInstanceProperties<OriginalFn extends Moizeable>(\n    memoized: Memoized<OriginalFn>,\n    {\n        expirations,\n        options: moizeOptions,\n        originalFunction,\n    }: MoizeConfiguration<OriginalFn>\n) {\n    const { options: microMemoizeOptions } = memoized;\n\n    Object.defineProperties(memoized, {\n        _microMemoizeOptions: {\n            configurable: true,\n            get() {\n                return microMemoizeOptions;\n            },\n        },\n\n        cacheSnapshot: {\n            configurable: true,\n            get() {\n                const { cache: currentCache } = memoized;\n\n                return {\n                    keys: currentCache.keys.slice(0),\n                    size: currentCache.size,\n                    values: currentCache.values.slice(0),\n                };\n            },\n        },\n\n        expirations: {\n            configurable: true,\n            get() {\n                return expirations;\n            },\n        },\n\n        expirationsSnapshot: {\n            configurable: true,\n            get() {\n                return expirations.slice(0);\n            },\n        },\n\n        isMoized: {\n            configurable: true,\n            get() {\n                return true;\n            },\n        },\n\n        options: {\n            configurable: true,\n            get() {\n                return moizeOptions;\n            },\n        },\n\n        originalFunction: {\n            configurable: true,\n            get() {\n                return originalFunction;\n            },\n        },\n    });\n\n    const moized = memoized as unknown as Moized<OriginalFn, Options>;\n\n    copyStaticProperties(originalFunction, moized);\n}\n\n/**\n * @private\n *\n * @description\n * add methods and properties to the memoized function for more features\n *\n * @param memoized the memoized function\n * @param configuration the configuration object for the instance\n * @returns the memoized function passed\n */\nexport function createMoizeInstance<\n    OriginalFn extends Moizeable,\n    CombinedOptions extends Options\n>(\n    memoized: Memoized<OriginalFn>,\n    configuration: MoizeConfiguration<OriginalFn>\n) {\n    addInstanceMethods<OriginalFn>(memoized, configuration);\n    addInstanceProperties<OriginalFn>(memoized, configuration);\n\n    return memoized as Moized<OriginalFn, CombinedOptions>;\n}\n","import { copyStaticProperties } from './instance';\nimport { Moize, Moized as MoizedFunction, Moizeable, Options } from './types';\nimport { setName } from './utils';\n\n// This was stolen from React internals, which allows us to create React elements without needing\n// a dependency on the React library itself.\nconst REACT_ELEMENT_TYPE =\n    typeof Symbol === 'function' && Symbol.for\n        ? Symbol.for('react.element')\n        : 0xeac7;\n\n/**\n * @private\n *\n * @description\n * Create a component that memoizes based on `props` and legacy `context`\n * on a per-instance basis. This requires creating a component class to\n * store the memoized function. The cost is quite low, and avoids the\n * need to have access to the React dependency by basically re-creating\n * the basic essentials for a component class and the results of the\n * `createElement` function.\n *\n * @param moizer the top-level moize method\n * @param fn the component to memoize\n * @param options the memoization options\n * @returns the memoized component\n */\nexport function createMoizedComponent<OriginalFn extends Moizeable>(\n    moizer: Moize,\n    fn: OriginalFn,\n    options: Options\n) {\n    /**\n     * This is a hack override setting the necessary options\n     * for a React component to be memoized. In the main `moize`\n     * method, if the `isReact` option is set it is short-circuited\n     * to call this function, and these overrides allow the\n     * necessary transformKey method to be derived.\n     *\n     * The order is based on:\n     * 1) Set the necessary aspects of transformKey for React components.\n     * 2) Allow setting of other options and overrides of those aspects\n     *    if desired (for example, `isDeepEqual` will use deep equality).\n     * 3) Always set `isReact` to false to prevent infinite loop.\n     */\n    const reactMoizer = moizer({\n        maxArgs: 2,\n        isShallowEqual: true,\n        ...options,\n        isReact: false,\n    });\n\n    if (!fn.displayName) {\n        // @ts-ignore - allow setting of displayName\n        fn.displayName = fn.name || 'Component';\n    }\n\n    function Moized<\n        Props extends Record<string, unknown>,\n        Context extends any,\n        Updater extends any\n    >(this: any, props: Props, context: Context, updater: Updater) {\n        this.props = props;\n        this.context = context;\n        this.updater = updater;\n\n        this.MoizedComponent = reactMoizer(fn);\n    }\n\n    Moized.prototype.isReactComponent = {};\n\n    Moized.prototype.render = function () {\n        return {\n            $$typeof: REACT_ELEMENT_TYPE,\n            type: this.MoizedComponent,\n            props: this.props,\n            ref: null,\n            key: null,\n            _owner: null,\n        } as JSX.Element;\n    };\n\n    copyStaticProperties(fn, Moized, ['contextType', 'contextTypes']);\n\n    Moized.displayName = `Moized(${fn.displayName || fn.name || 'Component'})`;\n\n    setName(Moized as MoizedFunction, fn.name, options.profileName);\n\n    return Moized;\n}\n","import { Key } from './types';\n\nexport function createGetInitialArgs(size: number) {\n    /**\n     * @private\n     *\n     * @description\n     * take the first N number of items from the array (faster than slice)\n     *\n     * @param args the args to take from\n     * @returns the shortened list of args as an array\n     */\n    return function (args: Key): Key {\n        if (size >= args.length) {\n            return args;\n        }\n\n        if (size === 0) {\n            return [];\n        }\n\n        if (size === 1) {\n            return [args[0]];\n        }\n\n        if (size === 2) {\n            return [args[0], args[1]];\n        }\n\n        if (size === 3) {\n            return [args[0], args[1], args[2]];\n        }\n\n        const clone = [];\n\n        for (let index = 0; index < size; index++) {\n            clone[index] = args[index];\n        }\n\n        return clone;\n    };\n}\n","import { Key, Options } from './types';\n\n/**\n * @function getCutoff\n *\n * @description\n * faster `Array.prototype.indexOf` implementation build for slicing / splicing\n *\n * @param array the array to match the value in\n * @param value the value to match\n * @returns the matching index, or -1\n */\nfunction getCutoff(array: any[], value: any) {\n    const { length } = array;\n\n    for (let index = 0; index < length; ++index) {\n        if (array[index] === value) {\n            return index + 1;\n        }\n    }\n\n    return 0;\n}\n\n/**\n * @private\n *\n * @description\n * custom replacer for the stringify function\n *\n * @returns if function then toString of it, else the value itself\n */\nexport function createDefaultReplacer() {\n    const cache: any[] = [];\n    const keys: string[] = [];\n\n    return function defaultReplacer(key: string, value: any) {\n        const type = typeof value;\n\n        if (type === 'function' || type === 'symbol') {\n            return value.toString();\n        }\n\n        if (typeof value === 'object') {\n            if (cache.length) {\n                const thisCutoff = getCutoff(cache, this);\n        \n                if (thisCutoff === 0) {\n                    cache[cache.length] = this;\n                } else {\n                    cache.splice(thisCutoff);\n                    keys.splice(thisCutoff);\n                }\n        \n                keys[keys.length] = key;\n        \n                const valueCutoff = getCutoff(cache, value);\n        \n                if (valueCutoff !== 0) {\n                    return `[ref=${keys.slice(0, valueCutoff).join('.') || '.'}]`;\n                }\n            } else {\n                cache[0] = value;\n                keys[0] = key;\n            }\n\n            return value;\n        }\n\n        return '' + value;\n    };\n}\n\n/**\n * @private\n *\n * @description\n * get the stringified version of the argument passed\n *\n * @param arg argument to stringify\n * @returns the stringified argument\n */\nexport function getStringifiedArgument<Type>(arg: Type) {\n    const typeOfArg = typeof arg;\n\n    return arg && (typeOfArg === 'object' || typeOfArg === 'function')\n        ? JSON.stringify(arg, createDefaultReplacer())\n        : arg;\n}\n\n/**\n * @private\n *\n * @description\n * serialize the arguments passed\n *\n * @param options the options passed to the moizer\n * @param options.maxArgs the cap on the number of arguments used in serialization\n * @returns argument serialization method\n */\nexport function defaultArgumentSerializer(args: Key) {\n    let key = '|';\n\n    for (let index = 0; index < args.length; index++) {\n        key += getStringifiedArgument(args[index]) + '|';\n    }\n\n    return [key];\n}\n\n/**\n * @private\n *\n * @description\n * based on the options passed, either use the serializer passed or generate the internal one\n *\n * @param options the options passed to the moized function\n * @returns the function to use in serializing the arguments\n */\nexport function getSerializerFunction(options: Options) {\n    return typeof options.serializer === 'function'\n        ? options.serializer\n        : defaultArgumentSerializer;\n}\n\n/**\n * @private\n *\n * @description\n * are the serialized keys equal to one another\n *\n * @param cacheKey the cache key to compare\n * @param key the key to test\n * @returns are the keys equal\n */\nexport function getIsSerializedKeyEqual(cacheKey: Key, key: Key) {\n    return cacheKey[0] === key[0];\n}\n","import { deepEqual, sameValueZeroEqual, shallowEqual } from 'fast-equals';\nimport { createGetInitialArgs } from './maxArgs';\nimport { getIsSerializedKeyEqual, getSerializerFunction } from './serialize';\nimport {\n    Cache,\n    IsEqual,\n    IsMatchingKey,\n    MicroMemoizeOptions,\n    Moized,\n    OnCacheOperation,\n    Options,\n    TransformKey,\n} from './types';\nimport { compose } from './utils';\n\nexport function createOnCacheOperation(\n    fn?: OnCacheOperation\n): OnCacheOperation {\n    if (typeof fn === 'function') {\n        return (\n            _cacheIgnored: Cache,\n            _microMemoizeOptionsIgnored: MicroMemoizeOptions,\n            memoized: Moized\n        ): void => fn(memoized.cache, memoized.options, memoized);\n    }\n}\n\n/**\n * @private\n *\n * @description\n * get the isEqual method passed to micro-memoize\n *\n * @param options the options passed to the moizer\n * @returns the isEqual method to apply\n */\nexport function getIsEqual(options: Options): IsEqual {\n    return (\n        options.matchesArg ||\n        (options.isDeepEqual && deepEqual) ||\n        (options.isShallowEqual && shallowEqual) ||\n        sameValueZeroEqual\n    );\n}\n\n/**\n * @private\n *\n * @description\n * get the isEqual method passed to micro-memoize\n *\n * @param options the options passed to the moizer\n * @returns the isEqual method to apply\n */\nexport function getIsMatchingKey(options: Options): IsMatchingKey | undefined {\n    return (\n        options.matchesKey ||\n        (options.isSerialized && getIsSerializedKeyEqual) ||\n        undefined\n    );\n}\n\n/**\n * @private\n *\n * @description\n * get the function that will transform the key based on the arguments passed\n *\n * @param options the options passed to the moizer\n * @returns the function to transform the key with\n */\nexport function getTransformKey(options: Options): TransformKey | undefined {\n    return compose(\n        options.isSerialized && getSerializerFunction(options),\n        typeof options.transformArgs === 'function' && options.transformArgs,\n        typeof options.maxArgs === 'number' &&\n            createGetInitialArgs(options.maxArgs)\n    ) as TransformKey;\n}\n","import { copyStaticProperties } from './instance';\n\nimport type { Moized } from './types';\n\nexport function createRefreshableMoized<MoizedFn extends Moized>(\n    moized: MoizedFn\n) {\n    const {\n        options: { updateCacheForKey },\n    } = moized;\n\n    /**\n     * @private\n     *\n     * @description\n     * Wrapper around already-`moize`d function which will intercept the memoization\n     * and call the underlying function directly with the purpose of updating the cache\n     * for the given key.\n     *\n     * Promise values use a tweak of the logic that exists at cache.updateAsyncCache, which\n     * reverts to the original value if the promise is rejected and there was already a cached\n     * value.\n     */\n    const refreshableMoized = function refreshableMoized(\n        this: any,\n        ...args: Parameters<typeof moized.fn>\n    ) {\n        if (!updateCacheForKey(args)) {\n            return moized.apply(this, args);\n        }\n\n        const result = moized.fn.apply(this, args);\n\n        moized.set(args, result);\n\n        return result;\n    } as typeof moized;\n\n    copyStaticProperties(moized, refreshableMoized);\n\n    return refreshableMoized;\n}\n","import memoize from 'micro-memoize';\nimport { createMoizedComponent } from './component';\nimport { DEFAULT_OPTIONS } from './constants';\nimport { createMoizeInstance } from './instance';\nimport { getMaxAgeOptions } from './maxAge';\nimport {\n    createOnCacheOperation,\n    getIsEqual,\n    getIsMatchingKey,\n    getTransformKey,\n} from './options';\nimport {\n    clearStats,\n    collectStats,\n    getDefaultProfileName,\n    getStats,\n    getStatsOptions,\n    statsCache,\n} from './stats';\nimport {\n    Expiration,\n    IsEqual,\n    IsMatchingKey,\n    MicroMemoizeOptions,\n    Moize,\n    Moizeable,\n    Moized,\n    OnExpire,\n    Options,\n    Serialize,\n    TransformKey,\n    UpdateCacheForKey,\n} from './types';\nimport { createRefreshableMoized } from './updateCacheForKey';\nimport { combine, compose, isMoized, mergeOptions, setName } from './utils';\n\nexport * from './types';\n\n/**\n * @module moize\n */\n\n/**\n * @description\n * memoize a function based its arguments passed, potentially improving runtime performance\n *\n * @example\n * import moize from 'moize';\n *\n * // standard implementation\n * const fn = (foo, bar) => `${foo} ${bar}`;\n * const memoizedFn = moize(fn);\n *\n * // implementation with options\n * const fn = async (id) => get(`http://foo.com/${id}`);\n * const memoizedFn = moize(fn, {isPromise: true, maxSize: 5});\n *\n * // implementation with convenience methods\n * const Foo = ({foo}) => <div>{foo}</div>;\n * const MemoizedFoo = moize.react(Foo);\n *\n * @param fn the function to memoized, or a list of options when currying\n * @param [options=DEFAULT_OPTIONS] the options to apply\n * @returns the memoized function\n */\nconst moize: Moize = function <\n    Fn extends Moizeable,\n    PassedOptions extends Options\n>(fn: Fn | PassedOptions, passedOptions?: PassedOptions) {\n    type CombinedOptions = Options & PassedOptions;\n\n    const options: Options = passedOptions || DEFAULT_OPTIONS;\n\n    if (isMoized(fn)) {\n        const moizeable = fn.originalFunction as Fn;\n        const mergedOptions = mergeOptions(\n            fn.options,\n            options\n        ) as CombinedOptions;\n\n        return moize<Fn, CombinedOptions>(moizeable, mergedOptions);\n    }\n\n    if (typeof fn === 'object') {\n        return function <\n            CurriedFn extends Moizeable,\n            CurriedOptions extends Options\n        >(\n            curriedFn: CurriedFn | CurriedOptions,\n            curriedOptions: CurriedOptions\n        ) {\n            type CombinedCurriedOptions = CombinedOptions & CurriedOptions;\n\n            if (typeof curriedFn === 'function') {\n                const mergedOptions = mergeOptions(\n                    fn as CombinedOptions,\n                    curriedOptions\n                ) as CombinedCurriedOptions;\n\n                return moize(curriedFn, mergedOptions);\n            }\n\n            const mergedOptions = mergeOptions(\n                fn as CombinedOptions,\n                curriedFn as CurriedOptions\n            );\n\n            return moize(mergedOptions);\n        };\n    }\n\n    if (options.isReact) {\n        return createMoizedComponent(moize, fn, options);\n    }\n\n    const coalescedOptions: Options = {\n        ...DEFAULT_OPTIONS,\n        ...options,\n        maxAge:\n            typeof options.maxAge === 'number' && options.maxAge >= 0\n                ? options.maxAge\n                : DEFAULT_OPTIONS.maxAge,\n        maxArgs:\n            typeof options.maxArgs === 'number' && options.maxArgs >= 0\n                ? options.maxArgs\n                : DEFAULT_OPTIONS.maxArgs,\n        maxSize:\n            typeof options.maxSize === 'number' && options.maxSize >= 0\n                ? options.maxSize\n                : DEFAULT_OPTIONS.maxSize,\n        profileName: options.profileName || getDefaultProfileName(fn),\n    };\n    const expirations: Array<Expiration> = [];\n\n    const {\n        matchesArg: equalsIgnored,\n        isDeepEqual: isDeepEqualIgnored,\n        isPromise,\n        isReact: isReactIgnored,\n        isSerialized: isSerialzedIgnored,\n        isShallowEqual: isShallowEqualIgnored,\n        matchesKey: matchesKeyIgnored,\n        maxAge: maxAgeIgnored,\n        maxArgs: maxArgsIgnored,\n        maxSize,\n        onCacheAdd,\n        onCacheChange,\n        onCacheHit,\n        onExpire: onExpireIgnored,\n        profileName: profileNameIgnored,\n        serializer: serializerIgnored,\n        updateCacheForKey,\n        transformArgs: transformArgsIgnored,\n        updateExpire: updateExpireIgnored,\n        ...customOptions\n    } = coalescedOptions;\n\n    const isEqual = getIsEqual(coalescedOptions);\n    const isMatchingKey = getIsMatchingKey(coalescedOptions);\n\n    const maxAgeOptions = getMaxAgeOptions(\n        expirations,\n        coalescedOptions,\n        isEqual,\n        isMatchingKey\n    );\n    const statsOptions = getStatsOptions(coalescedOptions);\n\n    const transformKey = getTransformKey(coalescedOptions);\n\n    const microMemoizeOptions: MicroMemoizeOptions = {\n        ...customOptions,\n        isEqual,\n        isMatchingKey,\n        isPromise,\n        maxSize,\n        onCacheAdd: createOnCacheOperation(\n            combine(\n                onCacheAdd,\n                maxAgeOptions.onCacheAdd,\n                statsOptions.onCacheAdd\n            )\n        ),\n        onCacheChange: createOnCacheOperation(onCacheChange),\n        onCacheHit: createOnCacheOperation(\n            combine(\n                onCacheHit,\n                maxAgeOptions.onCacheHit,\n                statsOptions.onCacheHit\n            )\n        ),\n        transformKey,\n    };\n\n    const memoized = memoize(fn, microMemoizeOptions);\n\n    let moized = createMoizeInstance<Fn, CombinedOptions>(memoized, {\n        expirations,\n        options: coalescedOptions,\n        originalFunction: fn,\n    });\n\n    if (updateCacheForKey) {\n        moized = createRefreshableMoized<typeof moized>(moized);\n    }\n\n    setName(moized, (fn as Moizeable).name, options.profileName);\n\n    return moized;\n};\n\n/**\n * @function\n * @name clearStats\n * @memberof module:moize\n * @alias moize.clearStats\n *\n * @description\n * clear all existing stats stored\n */\nmoize.clearStats = clearStats;\n\n/**\n * @function\n * @name collectStats\n * @memberof module:moize\n * @alias moize.collectStats\n *\n * @description\n * start collecting statistics\n */\nmoize.collectStats = collectStats;\n\n/**\n * @function\n * @name compose\n * @memberof module:moize\n * @alias moize.compose\n *\n * @description\n * method to compose moized methods and return a single moized function\n *\n * @param moized the functions to compose\n * @returns the composed function\n */\nmoize.compose = function (...moized: Moize[]) {\n    return compose<Moize>(...moized) || moize;\n};\n\n/**\n * @function\n * @name deep\n * @memberof module:moize\n * @alias moize.deep\n *\n * @description\n * should deep equality check be used\n *\n * @returns the moizer function\n */\nmoize.deep = moize({ isDeepEqual: true });\n\n/**\n * @function\n * @name getStats\n * @memberof module:moize\n * @alias moize.getStats\n *\n * @description\n * get the statistics of a given profile, or overall usage\n *\n * @returns statistics for a given profile or overall usage\n */\nmoize.getStats = getStats;\n\n/**\n * @function\n * @name infinite\n * @memberof module:moize\n * @alias moize.infinite\n *\n * @description\n * a moized method that will remove all limits from the cache size\n *\n * @returns the moizer function\n */\nmoize.infinite = moize({ maxSize: Infinity });\n\n/**\n * @function\n * @name isCollectingStats\n * @memberof module:moize\n * @alias moize.isCollectingStats\n *\n * @description\n * are stats being collected\n *\n * @returns are stats being collected\n */\nmoize.isCollectingStats = function isCollectingStats(): boolean {\n    return statsCache.isCollectingStats;\n};\n\n/**\n * @function\n * @name isMoized\n * @memberof module:moize\n * @alias moize.isMoized\n *\n * @description\n * is the fn passed a moized function\n *\n * @param fn the object to test\n * @returns is fn a moized function\n */\nmoize.isMoized = function isMoized(fn: any): fn is Moized {\n    return typeof fn === 'function' && !!fn.isMoized;\n};\n\n/**\n * @function\n * @name matchesArg\n * @memberof module:moize\n * @alias moize.matchesArg\n *\n * @description\n * a moized method where the arg matching method is the custom one passed\n *\n * @param keyMatcher the method to compare against those in cache\n * @returns the moizer function\n */\nmoize.matchesArg = function (argMatcher: IsEqual) {\n    return moize({ matchesArg: argMatcher });\n};\n\n/**\n * @function\n * @name matchesKey\n * @memberof module:moize\n * @alias moize.matchesKey\n *\n * @description\n * a moized method where the key matching method is the custom one passed\n *\n * @param keyMatcher the method to compare against those in cache\n * @returns the moizer function\n */\nmoize.matchesKey = function (keyMatcher: IsMatchingKey) {\n    return moize({ matchesKey: keyMatcher });\n};\n\nfunction maxAge<MaxAge extends number>(\n    maxAge: MaxAge\n): Moize<{ maxAge: MaxAge }>;\nfunction maxAge<MaxAge extends number, UpdateExpire extends boolean>(\n    maxAge: MaxAge,\n    expireOptions: UpdateExpire\n): Moize<{ maxAge: MaxAge; updateExpire: UpdateExpire }>;\nfunction maxAge<MaxAge extends number, ExpireHandler extends OnExpire>(\n    maxAge: MaxAge,\n    expireOptions: ExpireHandler\n): Moize<{ maxAge: MaxAge; onExpire: ExpireHandler }>;\nfunction maxAge<\n    MaxAge extends number,\n    ExpireHandler extends OnExpire,\n    ExpireOptions extends {\n        onExpire: ExpireHandler;\n    }\n>(\n    maxAge: MaxAge,\n    expireOptions: ExpireOptions\n): Moize<{ maxAge: MaxAge; onExpire: ExpireOptions['onExpire'] }>;\nfunction maxAge<\n    MaxAge extends number,\n    UpdateExpire extends boolean,\n    ExpireOptions extends {\n        updateExpire: UpdateExpire;\n    }\n>(\n    maxAge: MaxAge,\n    expireOptions: ExpireOptions\n): Moize<{ maxAge: MaxAge; updateExpire: UpdateExpire }>;\nfunction maxAge<\n    MaxAge extends number,\n    ExpireHandler extends OnExpire,\n    UpdateExpire extends boolean,\n    ExpireOptions extends {\n        onExpire: ExpireHandler;\n        updateExpire: UpdateExpire;\n    }\n>(\n    maxAge: MaxAge,\n    expireOptions: ExpireOptions\n): Moize<{\n    maxAge: MaxAge;\n    onExpire: ExpireHandler;\n    updateExpire: UpdateExpire;\n}>;\nfunction maxAge<\n    MaxAge extends number,\n    ExpireHandler extends OnExpire,\n    UpdateExpire extends boolean,\n    ExpireOptions extends {\n        onExpire?: ExpireHandler;\n        updateExpire?: UpdateExpire;\n    }\n>(\n    maxAge: MaxAge,\n    expireOptions?: ExpireHandler | UpdateExpire | ExpireOptions\n) {\n    if (expireOptions === true) {\n        return moize({\n            maxAge,\n            updateExpire: expireOptions,\n        });\n    }\n\n    if (typeof expireOptions === 'object') {\n        const { onExpire, updateExpire } = expireOptions;\n\n        return moize({\n            maxAge,\n            onExpire,\n            updateExpire,\n        });\n    }\n\n    if (typeof expireOptions === 'function') {\n        return moize({\n            maxAge,\n            onExpire: expireOptions,\n            updateExpire: true,\n        });\n    }\n\n    return moize({ maxAge });\n}\n\n/**\n * @function\n * @name maxAge\n * @memberof module:moize\n * @alias moize.maxAge\n *\n * @description\n * a moized method where the age of the cache is limited to the number of milliseconds passed\n *\n * @param maxAge the TTL of the value in cache\n * @returns the moizer function\n */\nmoize.maxAge = maxAge;\n\n/**\n * @function\n * @name maxArgs\n * @memberof module:moize\n * @alias moize.maxArgs\n *\n * @description\n * a moized method where the number of arguments used for determining cache is limited to the value passed\n *\n * @param maxArgs the number of args to base the key on\n * @returns the moizer function\n */\nmoize.maxArgs = function maxArgs(maxArgs: number) {\n    return moize({ maxArgs });\n};\n\n/**\n * @function\n * @name maxSize\n * @memberof module:moize\n * @alias moize.maxSize\n *\n * @description\n * a moized method where the total size of the cache is limited to the value passed\n *\n * @param maxSize the maximum size of the cache\n * @returns the moizer function\n */\nmoize.maxSize = function maxSize(maxSize: number) {\n    return moize({ maxSize });\n};\n\n/**\n * @function\n * @name profile\n * @memberof module:moize\n * @alias moize.profile\n *\n * @description\n * a moized method with a profile name\n *\n * @returns the moizer function\n */\nmoize.profile = function (profileName: string) {\n    return moize({ profileName });\n};\n\n/**\n * @function\n * @name promise\n * @memberof module:moize\n * @alias moize.promise\n *\n * @description\n * a moized method specific to caching resolved promise / async values\n *\n * @returns the moizer function\n */\nmoize.promise = moize({\n    isPromise: true,\n    updateExpire: true,\n});\n\n/**\n * @function\n * @name react\n * @memberof module:moize\n * @alias moize.react\n *\n * @description\n * a moized method specific to caching React element values\n *\n * @returns the moizer function\n */\nmoize.react = moize({ isReact: true });\n\n/**\n * @function\n * @name serialize\n * @memberof module:moize\n * @alias moize.serialize\n *\n * @description\n * a moized method that will serialize the arguments passed to use as the cache key\n *\n * @returns the moizer function\n */\nmoize.serialize = moize({ isSerialized: true });\n\n/**\n * @function\n * @name serializeWith\n * @memberof module:moize\n * @alias moize.serializeWith\n *\n * @description\n * a moized method that will serialize the arguments passed to use as the cache key\n * based on the serializer passed\n *\n * @returns the moizer function\n */\nmoize.serializeWith = function (serializer: Serialize) {\n    return moize({ isSerialized: true, serializer });\n};\n\n/**\n * @function\n * @name shallow\n * @memberof module:moize\n * @alias moize.shallow\n *\n * @description\n * should shallow equality check be used\n *\n * @returns the moizer function\n */\nmoize.shallow = moize({ isShallowEqual: true });\n\n/**\n * @function\n * @name transformArgs\n * @memberof module:moize\n * @alias moize.transformArgs\n *\n * @description\n * transform the args to allow for specific cache key comparison\n *\n * @param transformArgs the args transformer\n * @returns the moizer function\n */\nmoize.transformArgs = <Transformer extends TransformKey>(\n    transformArgs: Transformer\n) => moize({ transformArgs });\n\n/**\n * @function\n * @name updateCacheForKey\n * @memberof module:moize\n * @alias moize.updateCacheForKey\n *\n * @description\n * update the cache for a given key when the method passed returns truthy\n *\n * @param updateCacheForKey the method to determine when to update cache\n * @returns the moizer function\n */\nmoize.updateCacheForKey = <UpdateWhen extends UpdateCacheForKey>(\n    updateCacheForKey: UpdateWhen\n) => moize({ updateCacheForKey });\n\n// Add self-referring `default` property for edge-case cross-compatibility of mixed ESM/CommonJS usage.\n// This property is frozen and non-enumerable to avoid visibility on iteration or accidental overrides.\nObject.defineProperty(moize, 'default', {\n    configurable: false,\n    enumerable: false,\n    value: moize,\n    writable: false,\n});\n\nexport default moize;\n"],"names":["DEFAULT_OPTIONS","isDeepEqual","isPromise","isReact","isSerialized","isShallowEqual","matchesArg","undefined","matchesKey","maxAge","maxArgs","maxSize","onExpire","profileName","serializer","updateCacheForKey","transformArgs","updateExpire","combine","functions","reduce","f","g","apply","arguments","compose","findExpirationIndex","expirations","key","index","length","createFindKeyIndex","isEqual","isMatchingKey","areKeysEqual","cacheKey","keys","keysIndex","mergeOptions","originalOptions","newOptions","onCacheAdd","onCacheChange","onCacheHit","isMoized","fn","setName","originalFunctionName","name","Object","defineProperty","configurable","enumerable","value","writable","clearExpiration","shouldRemove","expirationIndex","clearTimeout","timeoutId","splice","createTimeout","expirationMethod","setTimeout","unref","createOnCacheAddSetExpiration","options","cache","moizedOptions","moized","findKeyIndex","keyIndex","values","unshift","push","createOnCacheHitResetExpiration","getMaxAgeOptions","isFinite","statsCache","anonymousProfileNameCounter","isCollectingStats","profiles","hasWarningDisplayed","clearStats","collectStats","createOnCacheAddIncrementCalls","calls","hits","createOnCacheHitIncrementCallsAndHits","getDefaultProfileName","stack","Error","fnName","displayName","lines","split","slice","line","profileNameLocation","indexOf","replace","trim","getUsagePercentage","toFixed","getStats","console","warn","usage","profile","completeStats","completeProfiles","computedProfiles","getStatsOptions","ALWAYS_SKIPPED_PROPERTIES","callee","caller","constructor","prototype","copyStaticProperties","originalFn","newFn","skippedProperties","getOwnPropertyNames","forEach","property","descriptor","getOwnPropertyDescriptor","get","set","addInstanceMethods","memoized","clear","_microMemoizeOptions","transformKey","has","cacheSnapshot","remove","existingKey","cutoff","size","updateAsyncCache","orderByLru","addInstanceProperties","moizeOptions","originalFunction","microMemoizeOptions","defineProperties","currentCache","expirationsSnapshot","createMoizeInstance","configuration","REACT_ELEMENT_TYPE","Symbol","for","createMoizedComponent","moizer","reactMoizer","Moized","props","context","updater","MoizedComponent","isReactComponent","render","$$typeof","type","ref","_owner","createGetInitialArgs","args","clone","getCutoff","array","createDefaultReplacer","defaultReplacer","toString","thisCutoff","valueCutoff","join","getStringifiedArgument","arg","typeOfArg","JSON","stringify","defaultArgumentSerializer","getSerializerFunction","getIsSerializedKeyEqual","createOnCacheOperation","_cacheIgnored","_microMemoizeOptionsIgnored","getIsEqual","deepEqual","shallowEqual","sameValueZeroEqual","getIsMatchingKey","getTransformKey","createRefreshableMoized","refreshableMoized","result","moize","passedOptions","moizeable","mergedOptions","curriedFn","curriedOptions","coalescedOptions","customOptions","maxAgeOptions","statsOptions","memoize","deep","infinite","Infinity","argMatcher","keyMatcher","expireOptions","promise","react","serialize","serializeWith","shallow"],"mappings":"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CH;EAED;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;;EACAkI,KAAK,CAACpH,UAAN,GAAmBA,UAAnB;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACAoH,KAAK,CAACnH,YAAN,GAAqBA,YAArB;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACAmH,KAAK,CAAC9K,OAAN,GAAgB,YAA8B;EAC1C,SAAOA,OAAO,MAAP,uBAA6B8K,KAApC;EACH,CAFD;EAIA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;;EACAA,KAAK,CAACW,IAAN,GAAaX,KAAK,CAAC;EAAEtM,EAAAA,WAAW,EAAE;EAAf,CAAD,CAAlB;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACAsM,KAAK,CAAC/F,QAAN,GAAiBA,QAAjB;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACA+F,KAAK,CAACY,QAAN,GAAiBZ,KAAK,CAAC;EAAE5L,EAAAA,OAAO,EAAEyM;EAAX,CAAD,CAAtB;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACAb,KAAK,CAACvH,iBAAN,GAA0B,SAASA,iBAAT,GAAsC;EAC5D,SAAOF,UAAU,CAACE,iBAAlB;EACH,CAFD;EAIA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;;EACAuH,KAAK,CAAC3J,QAAN,GAAiB,SAASA,QAAT,CAAkBC,EAAlB,EAAyC;EACtD,SAAO,OAAOA,EAAP,KAAc,UAAd,IAA4B,CAAC,CAACA,EAAE,CAACD,QAAxC;EACH,CAFD;EAIA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;;EACA2J,KAAK,CAACjM,UAAN,GAAmB,UAAU+M,UAAV,EAA+B;EAC9C,SAAOd,KAAK,CAAC;EAAEjM,IAAAA,UAAU,EAAE+M;EAAd,GAAD,CAAZ;EACH,CAF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"}