"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.addErrorPrint=exports.getError=void 0;var _util=require("util");

var _message=require("./message.js");
var _print=require("./print.js");
var _stack=require("./stack.js");

const{custom}=_util.inspect;



const getError=function({name,event}){
const message=(0,_message.getMessage)({event,name});
const mainValue=getMainValue(event);
const staticProps=getEventProps(mainValue);
const stackA=(0,_stack.getStack)(mainValue);
const error=buildError({name,message,stack:stackA,staticProps});
return{error,stack:stackA,mainValue};
};exports.getError=getError;


const getMainValue=function({value,nextValue:mainValue=value}){
return mainValue;
};


const getEventProps=function(mainValue){
if(mainValue instanceof Error){
return{...mainValue};
}

return{};
};

const buildError=function({name,message,stack,staticProps}){
const error=new Error(message);

Object.assign(error,staticProps);


Object.defineProperty(error,"name",{
value:capitalize(name),
enumerable:false,
writable:true,
configurable:true});


error.stack=`${error}\n${stack}`;
return error;
};

const capitalize=function(string){
const[firstLetter,...rest]=string;
return[firstLetter.toUpperCase(),...rest].join("");
};


const addErrorPrint=function({
error,
error:{message},
opts,
level,
name,
stack})
{
error[custom]=_print.printError.bind(undefined,{
opts,
level,
name,
message,
stack});

};exports.addErrorPrint=addErrorPrint;
//# sourceMappingURL=main.js.map