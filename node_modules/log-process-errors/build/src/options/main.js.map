{"version":3,"sources":["../../../src/options/main.js"],"names":["getOptions","opts","optsA","isDefined","exampleConfig","EXAMPLE_OPTS","validateOptions","optsB","level","optsC","DEFAULT_OPTS","optsD","key","value","undefined","getDefaultExitOn","isNewExitBehavior","version","NEW_EXIT_MIN_VERSION","log","defaultLog","exitOn","colors","DEFAULT_COLORS","exampleFunction","testing"],"mappings":"gGAAA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;AAKA;;AAEA,qC;;;AAGO,KAAMA,CAAAA,UAAU,CAAG,SAAU,CAAEC,IAAI,CAAG,EAAT,CAAV,CAAyB;AACjD,KAAMC,CAAAA,KAAK,CAAG,uBAAUD,IAAV,CAAgBE,SAAhB,CAAd;;AAEA,2BAASD,KAAT,CAAgB,CAAEE,aAAa,CAAEC,YAAjB,CAAhB;AACAC,eAAe,CAACJ,KAAD,CAAf;;AAEA,KAAMK,CAAAA,KAAK,CAAG,0BAAa,CAAEN,IAAI,CAAEC,KAAR,CAAb,CAAd;AACA,KAAMM,CAAAA,KAAK,CAAG,8BAAmB,CAAEP,IAAI,CAAEM,KAAR,CAAnB,CAAd;AACA,KAAME,CAAAA,KAAK,CAAG,CAAE,GAAGC,YAAL,CAAmB,GAAGH,KAAtB,CAA6BC,KAA7B,CAAd;;AAEA,KAAMG,CAAAA,KAAK,CAAG,qBAAS,CAAEV,IAAI,CAAEQ,KAAR,CAAT,CAAd;AACA,MAAOE,CAAAA,KAAP;AACD,CAZM,C;;AAcP,KAAMR,CAAAA,SAAS,CAAG,SAAUS,GAAV,CAAeC,KAAf,CAAsB;AACtC,MAAOA,CAAAA,KAAK,GAAKC,SAAjB;AACD,CAFD;;;;AAMA,KAAMC,CAAAA,gBAAgB,CAAG,UAAY;AACnC,GAAIC,iBAAiB,EAArB,CAAyB;AACvB,MAAO,CAAC,mBAAD,CAAsB,oBAAtB,CAAP;AACD;;AAED,MAAO,CAAC,mBAAD,CAAP;AACD,CAND;;AAQA,KAAMA,CAAAA,iBAAiB,CAAG,UAAY;AACpC,MAAO,gBAAWC,gBAAX,CAAoBC,oBAApB,CAAP;AACD,CAFD;;AAIA,KAAMA,CAAAA,oBAAoB,CAAG,QAA7B;;AAEA,KAAMR,CAAAA,YAAY,CAAG;AACnBS,GAAG,CAAEC,eADc;AAEnBC,MAAM,CAAEN,gBAAgB,EAFL;AAGnBO,MAAM,CAAEC,sBAHW,CAArB;;;;;AAQA,KAAMC,CAAAA,eAAe,CAAG,UAAY,CAAE,CAAtC;;AAEA,KAAMnB,CAAAA,YAAY,CAAG;AACnB,GAAGK,YADgB;AAEnBS,GAAG,CAAEK,eAFc;AAGnBhB,KAAK,CAAE,6BAHY;AAInBiB,OAAO,CAAE,gCAJU,CAArB;;;;AAQA,KAAMnB,CAAAA,eAAe,CAAG,SAAU,CAAEe,MAAF,CAAUb,KAAK,CAAG,EAAlB,CAAV,CAAkC;AACxD,0BAAe,CAAEA,KAAF,CAAf;AACA,yBAAe,CAAEa,MAAF,CAAf;AACD,CAHD","sourcesContent":["import { version } from 'process'\n\nimport filterObj from 'filter-obj'\nimport { validate } from 'jest-validate'\nimport { gte as gteVersion } from 'semver'\n\nimport { addChalk, DEFAULT_COLORS } from '../colors.js'\nimport { validateExitOn } from '../exit.js'\nimport {\n  applyDefaultLevels,\n  getExampleLevels,\n  validateLevels,\n} from '../level.js'\nimport { defaultLog } from '../log.js'\n\nimport { applyTesting, getExampleTesting } from './testing.js'\n\n// Validate options and assign default options\nexport const getOptions = function ({ opts = {} }) {\n  const optsA = filterObj(opts, isDefined)\n\n  validate(optsA, { exampleConfig: EXAMPLE_OPTS })\n  validateOptions(optsA)\n\n  const optsB = applyTesting({ opts: optsA })\n  const level = applyDefaultLevels({ opts: optsB })\n  const optsC = { ...DEFAULT_OPTS, ...optsB, level }\n\n  const optsD = addChalk({ opts: optsC })\n  return optsD\n}\n\nconst isDefined = function (key, value) {\n  return value !== undefined\n}\n\n// Since Node 15.0.0, `unhandledRejection` makes the process exit too\n// TODO: remove after dropping support for Node <15.0.0\nconst getDefaultExitOn = function () {\n  if (isNewExitBehavior()) {\n    return ['uncaughtException', 'unhandledRejection']\n  }\n\n  return ['uncaughtException']\n}\n\nconst isNewExitBehavior = function () {\n  return gteVersion(version, NEW_EXIT_MIN_VERSION)\n}\n\nconst NEW_EXIT_MIN_VERSION = '15.0.0'\n\nconst DEFAULT_OPTS = {\n  log: defaultLog,\n  exitOn: getDefaultExitOn(),\n  colors: DEFAULT_COLORS,\n}\n\n// `validate-jest` prints the function body\n// eslint-disable-next-line no-empty-function\nconst exampleFunction = function () {}\n\nconst EXAMPLE_OPTS = {\n  ...DEFAULT_OPTS,\n  log: exampleFunction,\n  level: getExampleLevels(),\n  testing: getExampleTesting(),\n}\n\n// Validation beyond what `jest-validate` can do\nconst validateOptions = function ({ exitOn, level = {} }) {\n  validateLevels({ level })\n  validateExitOn({ exitOn })\n}\n"],"file":"src/options/main.js"}